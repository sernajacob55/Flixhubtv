<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Movie • FlixHubTV</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>Flix<span>HubTV</span></h1>
    <div class="nav-buttons">
      <button onclick="location.href='index.html'">Home</button>
      <button onclick="location.href='profiles.html'">Switch Profile</button>
      <button onclick="location.href='login.html'">Logout</button>
    </div>
  </header>

  <main class="main-content">
    <div id="movieInfo"></div>
    <button class="watchlist-btn" id="watchlistBtn">+ Add to Watchlist</button>
    <button class="continue-btn" id="playBtn">▶ Play</button>
  </main>

  <footer>
    <p>&copy; 2025 FlixHubTV. All rights reserved.</p>
  </footer>

  <div id="playerContainer" class="video-player" style="display:none;">
    <button class="close-btn" onclick="closePlayer()">✕</button>
    <video id="videoPlayer" controls></video>
  </div>

  <script>
    const OMDB_KEY = "ea7569d7";
    const TMDB_KEY = "a2942c822ee97bc0df2dba1a65cf2d0f";

    const urlParams = new URLSearchParams(window.location.search);
    const imdbID = urlParams.get("id");

    const movieInfo = document.getElementById("movieInfo");
    const videoPlayer = document.getElementById("videoPlayer");

    // Map imdbID to MediaFire links
    const mediaLinks = {
      "tt0133093": "https://download1351.mediafire.com/moph99vymelgB4tgVyH9-EiWi8-NqEibljxmsFvx7MJGEr6mF6KBkWiSUCA99-DhpkeeA1m42myFlnxm20g63-4yxCtqulAo-babZQt1Nu68RQGklpbZcsAnQlBFgd8Qfgto6AOQrxZ7DqkDJ0Mw0RDXGlcCFra4ZLOqktfQiw2sbJY/rks796idw5xqo2i/The+Matrix.mp4",
      "tt0118928": "https://download1324.mediafire.com/cd5ev8gxoajggy5dbp_1pagixal-14NXp2krW0s3WdxiRxacbt_tmKEN5wBSXGhBxaHmQRL6a_oqit-_4Uqm6r7Th8gd02jAsy_iWXSiGUZejYG1i7-rTMQrhWr5Q8OQan-9adl7oEEEJK7mmWiPIvTIT_iyRk3hboxiQfNDUHmnI0Q/jtd07wddlls76o2/Dantes+Peak.mp4"
    };

    // Load metadata
    fetch(`https://www.omdbapi.com/?i=${imdbID}&apikey=${OMDB_KEY}`)
      .then(r => r.json())
      .then(data => {
        movieInfo.innerHTML = `
          <h2>${data.Title} (${data.Year})</h2>
          <p><strong>Genre:</strong> ${data.Genre}</p>
          <p><strong>Runtime:</strong> ${data.Runtime}</p>
          <p>${data.Plot}</p>
          <img src="${data.Poster}" alt="${data.Title} poster">
        `;
      });

    // Watchlist button
    const watchlistBtn = document.getElementById("watchlistBtn");
    watchlistBtn.addEventListener("click", () => {
      let watchlist = JSON.parse(localStorage.getItem("watchlist")) || [];
      if (watchlist.includes(imdbID)) {
        watchlist = watchlist.filter(id => id !== imdbID);
        watchlistBtn.textContent = "+ Add to Watchlist";
      } else {
        watchlist.push(imdbID);
        watchlistBtn.textContent = "✓ In Watchlist";
      }
      localStorage.setItem("watchlist", JSON.stringify(watchlist));
    });

    // Play button
    document.getElementById("playBtn").addEventListener("click", () => {
      const link = mediaLinks[imdbID];
      if (link) {
        document.getElementById("playerContainer").style.display = "flex";
        videoPlayer.src = link;
        videoPlayer.play();
        videoPlayer.requestFullscreen();
      }
    });

    // Close player
    function closePlayer() {
      const container = document.getElementById("playerContainer");
      container.style.display = "none";
      videoPlayer.pause();
      videoPlayer.src = "";
      if (document.fullscreenElement) {
        document.exitFullscreen();
      }
    }
  </script>
</body>
</html>